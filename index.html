<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Auth - Modern Signup/Login</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome for icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Custom styles for the page */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Style for the active tab */
        .tab-button.active {
            background-color: #4f46e5; /* indigo-600 */
            color: white;
        }
        /* Simple transition for tab buttons */
        .tab-button {
            transition: all 0.2s ease-in-out;
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900">t
    <div class="min-h-screen flex items-center justify-center bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500 p-4">
        <div class="w-full max-w-md bg-white dark:bg-gray-800 rounded-2xl shadow-2xl p-6 sm:p-8">
            <h2 class="text-3xl font-bold text-center text-gray-800 dark:text-white mb-2">Welcome Back! ðŸ‘‹</h2>
            <p class="text-center text-gray-500 dark:text-gray-400 mb-6">Please enter your details to continue.</p>

            <!-- Tab Buttons -->
            <div class="flex bg-gray-200 dark:bg-gray-700 rounded-lg p-1 mb-6">
                <button id="login-tab-btn" class="tab-button flex-1 py-2 px-4 rounded-md text-sm font-medium text-gray-700 dark:text-gray-300 focus:outline-none active">
                    Login
                </button>
                <button id="signup-tab-btn" class="tab-button flex-1 py-2 px-4 rounded-md text-sm font-medium text-gray-700 dark:text-gray-300 focus:outline-none">
                    Signup
                </button>
            </div>

            <!-- Tab Content -->
            <div>
                <!-- Login Form -->
                <div id="login-form-container">
                    <form id="loginForm" novalidate class="space-y-4">
                        <div>
                            <label for="loginEmail" class="text-sm font-medium text-gray-700 dark:text-gray-300">Email</label>
                            <input type="email" id="loginEmail" required class="mt-1 block w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                        </div>
                        <div class="relative">
                            <label for="loginPassword" class="text-sm font-medium text-gray-700 dark:text-gray-300">Password</label>
                            <input type="password" id="loginPassword" required minlength="4" class="mt-1 block w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                            <i class="fa-solid fa-eye absolute right-3 top-9 cursor-pointer text-gray-400" onclick="togglePassword('loginPassword', this)"></i>
                        </div>
                        <div>
                            <button type="submit" class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                                Login
                            </button>
                        </div>
                        <div id="loginMsg" class="text-sm text-center"></div>
                    </form>
                </div>

                <!-- Signup Form -->
                <div id="signup-form-container" class="hidden">
                    <form id="signupForm" novalidate class="space-y-4">
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                            <div>
                                <label for="firstName" class="text-sm font-medium text-gray-700 dark:text-gray-300">First Name</label>
                                <input type="text" id="firstName" required class="mt-1 block w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                            </div>
                            <div>
                                <label for="lastName" class="text-sm font-medium text-gray-700 dark:text-gray-300">Last Name</label>
                                <input type="text" id="lastName" required class="mt-1 block w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                            </div>
                        </div>
                        <div>
                            <label for="username" class="text-sm font-medium text-gray-700 dark:text-gray-300">Username</label>
                            <input type="text" id="username" required class="mt-1 block w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                        </div>
                        <div>
                            <label for="email" class="text-sm font-medium text-gray-700 dark:text-gray-300">Email</label>
                            <input type="email" id="email" required class="mt-1 block w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                        </div>
                        <div class="relative">
                            <label for="password" class="text-sm font-medium text-gray-700 dark:text-gray-300">Password</label>
                            <input type="password" id="password" required minlength="4" class="mt-1 block w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                            <i class="fa-solid fa-eye absolute right-3 top-9 cursor-pointer text-gray-400" onclick="togglePassword('password', this)"></i>
                        </div>
                        <div>
                            <button type="submit" class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500">
                                Create Account
                            </button>
                        </div>
                        <div id="signupMsg" class="text-sm text-center"></div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
        // DOM Elements
        const loginTabBtn = document.getElementById('login-tab-btn');
        const signupTabBtn = document.getElementById('signup-tab-btn');
        const loginFormContainer = document.getElementById('login-form-container');
        const signupFormContainer = document.getElementById('signup-form-container');

        // Function to switch between tabs
        function showTab(tabName) {
            if (tabName === 'login') {
                loginFormContainer.classList.remove('hidden');
                signupFormContainer.classList.add('hidden');
                loginTabBtn.classList.add('active');
                signupTabBtn.classList.remove('active');
            } else {
                loginFormContainer.classList.add('hidden');
                signupFormContainer.classList.remove('hidden');
                loginTabBtn.classList.remove('active');
                signupTabBtn.classList.add('active');
            }
        }

        // Event Listeners for tabs
        loginTabBtn.addEventListener('click', () => showTab('login'));
        signupTabBtn.addEventListener('click', () => showTab('signup'));

        // Password show/hide toggle
        function togglePassword(id, el) {
            const input = document.getElementById(id);
            if (input.type === "password") {
                input.type = "text";
                el.classList.remove("fa-eye");
                el.classList.add("fa-eye-slash");
            } else {
                input.type = "password";
                el.classList.remove("fa-eye-slash");
                el.classList.add("fa-eye");
            }
        }

        // Helper functions to read/write users from localStorage
        function getUsers() {
            try {
                const raw = localStorage.getItem('users');
                return raw ? JSON.parse(raw) : [];
            } catch (e) {
                console.error("Error reading users from localStorage", e);
                return [];
            }
        }

        function setUsers(users) {
            localStorage.setItem('users', JSON.stringify(users));
        }
        
        // Helper to display messages
        function showMessage(element, message, isSuccess) {
            element.textContent = message;
            element.className = `text-sm text-center ${isSuccess ? 'text-green-500' : 'text-red-500'}`;
        }

        // Signup Form Logic
        document.getElementById('signupForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const firstName = document.getElementById('firstName').value.trim();
            const lastName = document.getElementById('lastName').value.trim();
            const username = document.getElementById('username').value.trim().toLowerCase();
            const email = document.getElementById('email').value.trim().toLowerCase();
            const password = document.getElementById('password').value;

            const msgEl = document.getElementById('signupMsg');

            if (!firstName || !lastName || !username || !email || !password) {
                showMessage(msgEl, 'Please fill all fields.', false);
                return;
            }

            const users = getUsers();
            if (users.some(u => u.username === username)) {
                showMessage(msgEl, 'Username already exists.', false);
                return;
            }
            if (users.some(u => u.email === email)) {
                showMessage(msgEl, 'Email already exists.', false);
                return;
            }

            users.push({
                firstName,
                lastName,
                username,
                email,
                password,
                createdAt: Date.now()
            });
            setUsers(users);

            showMessage(msgEl, 'Account created! Please login.', true);
            document.getElementById('signupForm').reset();
            
            // Automatically switch to the login tab after successful signup
            setTimeout(() => {
                showTab('login');
                showMessage(msgEl, '', true); // Clear message after switch
            }, 1500);
        });

        // Login Form Logic
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value.trim().toLowerCase();
            const password = document.getElementById('loginPassword').value;
            const msgEl = document.getElementById('loginMsg');

            if (!email || !password) {
                showMessage(msgEl, 'Please enter email and password.', false);
                return;
            }

            const users = getUsers();
            const user = users.find(u => u.email === email && u.password === password);

            if (!user) {
                showMessage(msgEl, 'Invalid email or password.', false);
                return;
            }

            localStorage.setItem('currentUserEmail', user.email);
            showMessage(msgEl, 'Login successful! Redirecting...', true);

            // Redirect to another page after a short delay
            setTimeout(() => {
                window.location.href = 'ticket.html'; 
            }, 1000);
        });
    </script>
</body>
</html>
